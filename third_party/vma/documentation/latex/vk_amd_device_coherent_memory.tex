VK\+\_\+\+AMD\+\_\+device\+\_\+coherent\+\_\+memory is a device extension that enables access to additional memory types with {\ttfamily VK\+\_\+\+MEMORY\+\_\+\+PROPERTY\+\_\+\+DEVICE\+\_\+\+COHERENT\+\_\+\+BIT\+\_\+\+AMD} and {\ttfamily VK\+\_\+\+MEMORY\+\_\+\+PROPERTY\+\_\+\+DEVICE\+\_\+\+UNCACHED\+\_\+\+BIT\+\_\+\+AMD} flag. It is useful mostly for allocation of buffers intended for writing \char`\"{}breadcrumb markers\char`\"{} in between passes or draw calls, which in turn are useful for debugging GPU crash/hang/\+TDR cases.

When the extension is available but has not been enabled, Vulkan physical device still exposes those memory types, but their usage is forbidden. VMA automatically takes care of that -\/ it returns {\ttfamily VK\+\_\+\+ERROR\+\_\+\+FEATURE\+\_\+\+NOT\+\_\+\+PRESENT} when an attempt to allocate memory of such type is made.

If you want to use this extension in connection with VMA, follow these steps\+:\hypertarget{vk_amd_device_coherent_memory_vk_amd_device_coherent_memory_initialization}{}\doxysection{Initialization}\label{vk_amd_device_coherent_memory_vk_amd_device_coherent_memory_initialization}
1) Call {\ttfamily vk\+Enumerate\+Device\+Extension\+Properties} for the physical device. Check if the extension is supported -\/ if returned array of {\ttfamily Vk\+Extension\+Properties} contains \char`\"{}\+VK\+\_\+\+AMD\+\_\+device\+\_\+coherent\+\_\+memory\char`\"{}.

2) Call {\ttfamily vk\+Get\+Physical\+Device\+Features2} for the physical device instead of old {\ttfamily vk\+Get\+Physical\+Device\+Features}. Attach additional structure {\ttfamily Vk\+Physical\+Device\+Coherent\+Memory\+Features\+AMD} to {\ttfamily Vk\+Physical\+Device\+Features2\+::p\+Next} to be returned. Check if the device feature is really supported -\/ check if {\ttfamily Vk\+Physical\+Device\+Coherent\+Memory\+Features\+AMD\+::device\+Coherent\+Memory} is true.

3) While creating device with {\ttfamily vk\+Create\+Device}, enable this extension -\/ add \char`\"{}\+VK\+\_\+\+AMD\+\_\+device\+\_\+coherent\+\_\+memory\char`\"{} to the list passed as {\ttfamily Vk\+Device\+Create\+Info\+::pp\+Enabled\+Extension\+Names}.

4) While creating the device, also don\textquotesingle{}t set {\ttfamily Vk\+Device\+Create\+Info\+::p\+Enabled\+Features}. Fill in {\ttfamily Vk\+Physical\+Device\+Features2} structure instead and pass it as {\ttfamily Vk\+Device\+Create\+Info\+::p\+Next}. Enable this device feature -\/ attach additional structure {\ttfamily Vk\+Physical\+Device\+Coherent\+Memory\+Features\+AMD} to {\ttfamily Vk\+Physical\+Device\+Features2\+::p\+Next} and set its member {\ttfamily device\+Coherent\+Memory} to {\ttfamily VK\+\_\+\+TRUE}.

5) While creating \mbox{\hyperlink{structVmaAllocator}{Vma\+Allocator}} with vma\+Create\+Allocator() inform VMA that you have enabled this extension and feature -\/ add \#\+VMA\+\_\+\+ALLOCATOR\+\_\+\+CREATE\+\_\+\+AMD\+\_\+\+DEVICE\+\_\+\+COHERENT\+\_\+\+MEMORY\+\_\+\+BIT to \mbox{\hyperlink{structVmaAllocatorCreateInfo_a392ea2ecbaff93f91a7c49f735ad4346}{Vma\+Allocator\+Create\+Info\+::flags}}.\hypertarget{vk_amd_device_coherent_memory_vk_amd_device_coherent_memory_usage}{}\doxysection{Usage}\label{vk_amd_device_coherent_memory_vk_amd_device_coherent_memory_usage}
After following steps described above, you can create VMA allocations and custom pools out of the special {\ttfamily DEVICE\+\_\+\+COHERENT} and {\ttfamily DEVICE\+\_\+\+UNCACHED} memory types on eligible devices. There are multiple ways to do it, for example\+:


\begin{DoxyItemize}
\item You can request or prefer to allocate out of such memory types by adding {\ttfamily VK\+\_\+\+MEMORY\+\_\+\+PROPERTY\+\_\+\+DEVICE\+\_\+\+COHERENT\+\_\+\+BIT\+\_\+\+AMD} to \mbox{\hyperlink{structVmaAllocationCreateInfo_a9166390303ff42d783305bc31c2b6b90}{Vma\+Allocation\+Create\+Info\+::required\+Flags}} or \mbox{\hyperlink{structVmaAllocationCreateInfo_a7fe8d81a1ad10b2a2faacacee5b15d6d}{Vma\+Allocation\+Create\+Info\+::preferred\+Flags}}. Those flags can be freely mixed with other ways of \mbox{\hyperlink{choosing_memory_type}{Choosing memory type}}, like setting \mbox{\hyperlink{structVmaAllocationCreateInfo_accb8b06b1f677d858cb9af20705fa910}{Vma\+Allocation\+Create\+Info\+::usage}}.
\item If you manually found memory type index to use for this purpose, force allocation from this specific index by setting \mbox{\hyperlink{structVmaAllocationCreateInfo_a3bf940c0271d85d6ba32a4d820075055}{Vma\+Allocation\+Create\+Info\+::memory\+Type\+Bits}} {\ttfamily = 1u $<$$<$ index}.
\end{DoxyItemize}\hypertarget{vk_amd_device_coherent_memory_vk_amd_device_coherent_memory_more_information}{}\doxysection{More information}\label{vk_amd_device_coherent_memory_vk_amd_device_coherent_memory_more_information}
To learn more about this extension, see \href{https://www.khronos.org/registry/vulkan/specs/1.2-extensions/html/chap44.html\#VK_AMD_device_coherent_memory}{\texttt{ VK\+\_\+\+AMD\+\_\+device\+\_\+coherent\+\_\+memory in Vulkan specification}}

Example use of this extension can be found in the code of the sample and test suite accompanying this library. 